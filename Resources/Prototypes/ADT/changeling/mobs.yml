- type: entity
  id: MobMonkeyChangeling
  parent: MobMonkey
  suffix: changeling
  noSpawn: true
  components:
  - type: LanguageSpeaker # Frontier
    speaks:
    - Monkey
    understands:
    - GalacticCommon
    - Monkey

- type: polymorph
  id: ChangelingLesserForm
  configuration:
    entity: MobMonkeyChangeling
    forced: true
    inventory: Drop
    allowRepeatedMorphs: true

- type: entity
  name: changeling slug
  parent: SimpleMobBase
  id: ChangelingHeadslug
  description: e
  components:
  - type: Body
    prototype: Mouse
  - type: Speech
    speechSounds: Squeak
    speechVerb: SmallMob
  - type: Sprite
    drawdepth: SmallMobs
    sprite: ADT/Mobs/Aliens/headslug.rsi
    layers:
    - map: ["enum.DamageStateVisualLayers.Base"]
      state: headslug
  - type: Item
    size: Tiny
  - type: NpcFactionMember
    factions:
      - Mouse
  - type: HTN
    rootTask:
      task: MouseCompound
  - type: Physics
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.2
        density: 100
        mask:
        - SmallMobMask
        layer:
        - SmallMobLayer
  - type: MobState
  - type: Deathgasp
  - type: MobStateActions
    actions:
      Critical:
      - ActionCritSuccumb
      - ActionCritFakeDeath
      - ActionCritLastWords
  - type: MobThresholds
    thresholds:
      0: Alive
      69: Critical
      70: Dead
  - type: MovementSpeedModifier
    baseWalkSpeed : 5
    baseSprintSpeed : 5
  - type: DamageStateVisuals
    states:
      Alive:
        Base: headslug
      Critical:
        Base: headslug_dead
      Dead:
        Base: headslug_dead
  - type: Food
  - type: Tag
    tags:
    - ShoesRequiredStepTriggerImmune
  - type: Respirator
    damage:
      types:
        Asphyxiation: 0.25
    damageRecovery:
      types:
        Asphyxiation: -0.25
  - type: Barotrauma
    damage:
      types:
        Blunt: 0.1
  - type: Vocal
    sounds:
      Male: Mouse
      Female: Mouse
      Unsexed: Mouse
    wilhelmProbability: 0.001
  # TODO: Remove CombatMode when Prototype Composition is added
  - type: CombatMode
  - type: Bloodstream
    bloodMaxVolume: 50
  - type: CanEscapeInventory
  - type: MobPrice
    price: 5000
  - type: BadFood
  - type: NonSpreaderZombie
  - type: PreventSpiller
  - type: LanguageSpeaker # Frontier
    speaks:
    - Xeno
    understands:
    - Xeno
  - type: MeleeWeapon
    soundHit:
      path: /Audio/Weapons/pierce.ogg
    angle: 30
    animation: WeaponArcPunch
    damage:
      types:
        Piercing: 10
  - type: LingSlug

- type: entity
  name: changeling slug
  parent: SimpleMobBase
  id: ChangelingHeadslugSpread
  suffix: Spreader
  description: e
  components:
  - type: Body
    prototype: Mouse
  - type: Speech
    speechSounds: Squeak
    speechVerb: SmallMob
  - type: Sprite
    drawdepth: SmallMobs
    sprite: ADT/Mobs/Aliens/headslug.rsi
    layers:
    - map: ["enum.DamageStateVisualLayers.Base"]
      state: headslug
  - type: Item
    size: Tiny
  - type: NpcFactionMember
    factions:
      - Mouse
  - type: HTN
    rootTask:
      task: MouseCompound
  - type: Physics
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.2
        density: 100
        mask:
        - SmallMobMask
        layer:
        - SmallMobLayer
  - type: MobState
  - type: Deathgasp
  - type: MobStateActions
    actions:
      Critical:
      - ActionCritSuccumb
      - ActionCritFakeDeath
      - ActionCritLastWords
  - type: MobThresholds
    thresholds:
      0: Alive
      69: Critical
      70: Dead
  - type: MovementSpeedModifier
    baseWalkSpeed : 5
    baseSprintSpeed : 5
  - type: DamageStateVisuals
    states:
      Alive:
        Base: headslug
      Critical:
        Base: headslug_dead
      Dead:
        Base: headslug_dead
  - type: Food
  - type: Tag
    tags:
    - ShoesRequiredStepTriggerImmune
  - type: Respirator
    damage:
      types:
        Asphyxiation: 0.25
    damageRecovery:
      types:
        Asphyxiation: -0.25
  - type: Barotrauma
    damage:
      types:
        Blunt: 0.1
  - type: Vocal
    sounds:
      Male: Mouse
      Female: Mouse
      Unsexed: Mouse
    wilhelmProbability: 0.001
  # TODO: Remove CombatMode when Prototype Composition is added
  - type: CombatMode
  - type: Bloodstream
    bloodMaxVolume: 50
  - type: CanEscapeInventory
  - type: MobPrice
    price: 5000
  - type: BadFood
  - type: NonSpreaderZombie
  - type: PreventSpiller
  - type: LanguageSpeaker # Frontier
    speaks:
    - Xeno
    understands:
    - Xeno
  - type: MeleeWeapon
    soundHit:
      path: /Audio/Weapons/pierce.ogg
    angle: 30
    animation: WeaponArcPunch
    damage:
      types:
        Piercing: 10
  - type: LingSlug
    spread: true
    eggsAction: ActionLingHatchFast

- type: reagent
  id: LingToxin
  name: reagent-name-toxin
  group: Toxins
  desc: reagent-desc-toxin
  flavor: bitter
  color: "#cf3600"
  physicalDesc: reagent-physical-desc-opaque
  plantMetabolism:
  - !type:PlantAdjustToxins
    amount: 10
  - !type:PlantAdjustHealth
    amount: -5
  metabolisms:
    Poison:
      effects:
      - !type:HealthChange
        damage:
          types:
            Poison: 2


- type: reagent
  id: ADTLingEggs # Немножко костылей, но кому не пофиг?
  name: reagent-name-ling
  group: Toxins
  desc: reagent-desc-ling
  flavor: bitter
  physicalDesc: reagent-physical-desc-skunky
  color: "#ffd478"
  worksOnTheDead: true
  metabolisms:
    Medicine:
      effects:
      - !type:LingEggs
         conditions:
          - !type:ReagentThreshold
            min: 1
      - !type:HealthChange
        damage:
          types:
            Poison: 15

- type: entity
  name: synthetic changeling larva
  parent: FoodBreadSliceBase
  id: ADTLingLarva
  description: No... Don't do it...
  components:
  - type: Food
  - type: Item
    sprite: ADT/Objects/Specific/genо_larva_white.rsi
    inhandVisuals:
      left:
      - state: inhand-left
      right:
      - state: inhand-right
  - type: Sprite
    sprite: ADT/Objects/Specific/genо_larva_white.rsi
    layers:
    - state: icon
  - type: SolutionContainerManager
    solutions:
      food:
        maxVol: 4
        reagents:
        - ReagentId: ADTLingEggs
          Quantity: 4 # Just using the same values as the bun values, since the recipe for taco shells is roughly the same as buns.
  - type: Tag
    tags:
    - ADTCarnivoreFriendlyFood
  - type: FlavorProfile
    flavors:
      - terrible

- type: reaction
  id: ADTLingLarva #без понятия, как там у тебя личинка называется
  quantized: true
  reactants:
    ADTMPolymorphine:
      amount: 15
    Nutriment: #ну, раз мы создаём что-то биологическое, то пусть будут ещё и биологические приколы.
      amount: 3
    Stimulants:
      amount: 5
  effects:
    - !type:CreateEntityReactionEffect
      entity: ADTLingLarva #сам подставишь id сущности.

- type: entity
  parent: ChangelingHeadslug
  id: ChangelingHeadslugMidround
  suffix: Ghost role
  components:
  - type: GenericAntag
    rule: LingMidround

- type: entity
  parent: BaseGameRule
  id: MidroundChangelingSpawn
  noSpawn: true
  components:
  - type: StationEvent
    weight: 10
    duration: 1
    earliestStart: 30
    minimumPlayers: 40
  - type: RandomSpawnRule
    prototype: SpawnPointGhostLing

- type: entity
  noSpawn: true
  parent: BaseGameRule
  id: LingMidround
  components:
  - type: GenericAntagRule
    agentName: ling-round-end-agent-name  
    objectives:
    - EscapeLingShuttleObjective

- type: entity
  parent: MarkerBase
  id: SpawnPointGhostLing
  name: changeling spawn point
  components:
  - type: GhostRole
    name: ghost-role-information-ling-name
    description: ghost-role-information-ling-description
    rules: ghost-role-information-ling-rules
  - type: GhostRoleMobSpawner
    prototype: ChangelingHeadslugMidround
  - type: Sprite
    sprite: ADT/Mobs/Aliens/headslug.rsi
    layers:
    - map: ["enum.DamageStateVisualLayers.Base"]
      state: headslug
